<html>
<body>

<link rel="stylesheet" href="main.css">
<link rel="stylesheet" href="icons.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/xcode.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
<script src="//code.jquery.com/jquery-2.1.3.min.js"></script>
<script src="nunjucks.min.js"></script>

<script>
hljs.initHighlightingOnLoad();
</script>

<pre><code class="js" id="main">/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */

/*
 * Handles the validation callback from nsIFormFillController and
 * the display of the help panel on invalid elements.
 */

"use strict";

let <span data-id="0" data-kind=def >Cc</span> = <span data-id="?" data-kind=use >Components</span>.<span data-id="#classes" data-kind=use data-extra="Components#classes">classes</span>;
let <span data-id="1" data-kind=def >Ci</span> = <span data-id="?" data-kind=use >Components</span>.<span data-id="#interfaces" data-kind=use data-extra="Components#interfaces">interfaces</span>;
let <span data-id="2" data-kind=def >Cu</span> = <span data-id="?" data-kind=use >Components</span>.<span data-id="#utils" data-kind=use data-extra="Components#utils">utils</span>;

let <span data-id="3" data-kind=def >HTMLInputElement</span> = <span data-id="1" data-kind=use >Ci</span>.<span data-id="#nsIDOMHTMLInputElement" data-kind=use data-extra="Ci#nsIDOMHTMLInputElement">nsIDOMHTMLInputElement</span>;
let <span data-id="4" data-kind=def >HTMLTextAreaElement</span> = <span data-id="1" data-kind=use >Ci</span>.<span data-id="#nsIDOMHTMLTextAreaElement" data-kind=use data-extra="Ci#nsIDOMHTMLTextAreaElement">nsIDOMHTMLTextAreaElement</span>;
let <span data-id="5" data-kind=def >HTMLSelectElement</span> = <span data-id="1" data-kind=use >Ci</span>.<span data-id="#nsIDOMHTMLSelectElement" data-kind=use data-extra="Ci#nsIDOMHTMLSelectElement">nsIDOMHTMLSelectElement</span>;
let <span data-id="6" data-kind=def >HTMLButtonElement</span> = <span data-id="1" data-kind=use >Ci</span>.<span data-id="#nsIDOMHTMLButtonElement" data-kind=use data-extra="Ci#nsIDOMHTMLButtonElement">nsIDOMHTMLButtonElement</span>;

this.<span data-id="#EXPORTED_SYMBOLS" data-kind=assign >EXPORTED_SYMBOLS</span> = [ "FormSubmitObserver" ];

<span data-id="2" data-kind=use >Cu</span>.<span data-id="#import" data-kind=use data-extra="Cu#import">import</span>("resource://gre/modules/XPCOMUtils.jsm");
<span data-id="2" data-kind=use >Cu</span>.<span data-id="#import" data-kind=use data-extra="Cu#import">import</span>("resource://gre/modules/Services.jsm");
<span data-id="2" data-kind=use >Cu</span>.<span data-id="#import" data-kind=use data-extra="Cu#import">import</span>("resource://gre/modules/BrowserUtils.jsm");

function <span data-id="7" data-kind=def >FormSubmitObserver</span>(<span data-id="8" data-kind=def >aWindow</span>, <span data-id="9" data-kind=def >aTabChildGlobal</span>) {
  this.<span data-id="#init" data-kind=use >init</span>(<span data-id="8" data-kind=use >aWindow</span>, <span data-id="9" data-kind=use >aTabChildGlobal</span>);
}

<span data-id="7" data-kind=use >FormSubmitObserver</span>.<span data-id="#prototype" data-kind=assign data-extra="FormSubmitObserver#prototype">prototype</span> =
{
  <span data-id="#_validationMessage" data-kind=def data-extra="FormSubmitObserver#_validationMessage">_validationMessage</span>: "",
  <span data-id="#_content" data-kind=def data-extra="FormSubmitObserver#_content">_content</span>: null,
  <span data-id="#_element" data-kind=def data-extra="FormSubmitObserver#_element">_element</span>: null,

  /*
   * Public apis
   */

  <span data-id="#init" data-kind=def data-extra="FormSubmitObserver#init">init</span>: function(<span data-id="10" data-kind=def >aWindow</span>, <span data-id="11" data-kind=def >aTabChildGlobal</span>)
  {
    this.<span data-id="#_content" data-kind=assign data-extra="FormSubmitObserver#_content">_content</span> = <span data-id="10" data-kind=use >aWindow</span>;
    this.<span data-id="#_tab" data-kind=assign data-extra="FormSubmitObserver#_tab">_tab</span> = <span data-id="11" data-kind=use >aTabChildGlobal</span>;
    this.<span data-id="#_mm" data-kind=assign data-extra="FormSubmitObserver#_mm">_mm</span> = 
      this.<span data-id="#_content" data-kind=use data-extra="FormSubmitObserver#_content">_content</span>.<span data-id="#QueryInterface" data-kind=use >QueryInterface</span>(<span data-id="1" data-kind=use >Ci</span>.<span data-id="#nsIInterfaceRequestor" data-kind=use data-extra="Ci#nsIInterfaceRequestor">nsIInterfaceRequestor</span>)
                   .<span data-id="#getInterface" data-kind=use >getInterface</span>(<span data-id="1" data-kind=use >Ci</span>.<span data-id="#nsIDocShell" data-kind=use data-extra="Ci#nsIDocShell">nsIDocShell</span>)
                   .<span data-id="#sameTypeRootTreeItem" data-kind=use >sameTypeRootTreeItem</span>
                   .<span data-id="#QueryInterface" data-kind=use >QueryInterface</span>(<span data-id="1" data-kind=use >Ci</span>.<span data-id="#nsIDocShell" data-kind=use data-extra="Ci#nsIDocShell">nsIDocShell</span>)
                   .<span data-id="#QueryInterface" data-kind=use >QueryInterface</span>(<span data-id="1" data-kind=use >Ci</span>.<span data-id="#nsIInterfaceRequestor" data-kind=use data-extra="Ci#nsIInterfaceRequestor">nsIInterfaceRequestor</span>)
                   .<span data-id="#getInterface" data-kind=use >getInterface</span>(<span data-id="1" data-kind=use >Ci</span>.<span data-id="#nsIContentFrameMessageManager" data-kind=use data-extra="Ci#nsIContentFrameMessageManager">nsIContentFrameMessageManager</span>);

    // nsIFormSubmitObserver callback about invalid forms. See HTMLFormElement
    // for details.
    <span data-id="?" data-kind=use >Services</span>.<span data-id="#obs" data-kind=use data-extra="Services#obs">obs</span>.<span data-id="#addObserver" data-kind=use >addObserver</span>(this, "invalidformsubmit", false);
    this.<span data-id="#_tab" data-kind=use data-extra="FormSubmitObserver#_tab">_tab</span>.<span data-id="#addEventListener" data-kind=use >addEventListener</span>("pageshow", this, false);
    this.<span data-id="#_tab" data-kind=use data-extra="FormSubmitObserver#_tab">_tab</span>.<span data-id="#addEventListener" data-kind=use >addEventListener</span>("unload", this, false);
  },

  <span data-id="#uninit" data-kind=def data-extra="FormSubmitObserver#uninit">uninit</span>: function()
  {
    <span data-id="?" data-kind=use >Services</span>.<span data-id="#obs" data-kind=use data-extra="Services#obs">obs</span>.<span data-id="#removeObserver" data-kind=use >removeObserver</span>(this, "invalidformsubmit");
    this.<span data-id="#_content" data-kind=use data-extra="FormSubmitObserver#_content">_content</span>.<span data-id="#removeEventListener" data-kind=use >removeEventListener</span>("pageshow", this, false);
    this.<span data-id="#_content" data-kind=use data-extra="FormSubmitObserver#_content">_content</span>.<span data-id="#removeEventListener" data-kind=use >removeEventListener</span>("unload", this, false);
    this.<span data-id="#_mm" data-kind=assign data-extra="FormSubmitObserver#_mm">_mm</span> = null;
    this.<span data-id="#_element" data-kind=assign data-extra="FormSubmitObserver#_element">_element</span> = null;
    this.<span data-id="#_content" data-kind=assign data-extra="FormSubmitObserver#_content">_content</span> = null;
    this.<span data-id="#_tab" data-kind=assign data-extra="FormSubmitObserver#_tab">_tab</span> = null;
  },

  /*
   * Events
   */

  <span data-id="#handleEvent" data-kind=def data-extra="FormSubmitObserver#handleEvent">handleEvent</span>: function (<span data-id="12" data-kind=def >aEvent</span>) {
    switch (<span data-id="12" data-kind=use >aEvent</span>.<span data-id="#type" data-kind=use data-extra="aEvent#type">type</span>) {
      case "pageshow":
        if (this.<span data-id="#_isRootDocumentEvent" data-kind=use data-extra="FormSubmitObserver#_isRootDocumentEvent">_isRootDocumentEvent</span>(<span data-id="12" data-kind=use >aEvent</span>)) {
          this.<span data-id="#_hidePopup" data-kind=use data-extra="FormSubmitObserver#_hidePopup">_hidePopup</span>();
        }
        break;
      case "unload":
        this.<span data-id="#uninit" data-kind=use data-extra="FormSubmitObserver#uninit">uninit</span>();
        break;
      case "input":
        this.<span data-id="#_onInput" data-kind=use data-extra="FormSubmitObserver#_onInput">_onInput</span>(<span data-id="12" data-kind=use >aEvent</span>);
        break;
      case "blur":
        this.<span data-id="#_onBlur" data-kind=use data-extra="FormSubmitObserver#_onBlur">_onBlur</span>(<span data-id="12" data-kind=use >aEvent</span>);
        break;
    }
  },

  /*
   * nsIFormSubmitObserver
   */

  <span data-id="#notifyInvalidSubmit" data-kind=def data-extra="FormSubmitObserver#notifyInvalidSubmit">notifyInvalidSubmit</span> : function (<span data-id="13" data-kind=def >aFormElement</span>, <span data-id="14" data-kind=def >aInvalidElements</span>)
  {
    // We are going to handle invalid form submission attempt by focusing the
    // first invalid element and show the corresponding validation message in a
    // panel attached to the element.
    if (!<span data-id="14" data-kind=use >aInvalidElements</span>.<span data-id="#length" data-kind=use data-extra="aInvalidElements#length">length</span>) {
      return;
    }
    
    // Insure that this is the FormSubmitObserver associated with the form
    // element / window this notification is about.
    if (this.<span data-id="#_content" data-kind=use data-extra="FormSubmitObserver#_content">_content</span> != <span data-id="13" data-kind=use >aFormElement</span>.<span data-id="#ownerDocument" data-kind=use data-extra="aFormElement#ownerDocument">ownerDocument</span>.<span data-id="#defaultView" data-kind=use >defaultView</span>.<span data-id="#top" data-kind=use >top</span>.<span data-id="#document" data-kind=use >document</span>.<span data-id="#defaultView" data-kind=use >defaultView</span>) {
      return;
    }

    let <span data-id="15" data-kind=def >element</span> = <span data-id="14" data-kind=use >aInvalidElements</span>.<span data-id="#queryElementAt" data-kind=use data-extra="aInvalidElements#queryElementAt">queryElementAt</span>(0, <span data-id="1" data-kind=use >Ci</span>.<span data-id="#nsISupports" data-kind=use data-extra="Ci#nsISupports">nsISupports</span>);
    if (!(<span data-id="15" data-kind=use >element</span> instanceof <span data-id="3" data-kind=use >HTMLInputElement</span> ||
          <span data-id="15" data-kind=use >element</span> instanceof <span data-id="4" data-kind=use >HTMLTextAreaElement</span> ||
          <span data-id="15" data-kind=use >element</span> instanceof <span data-id="5" data-kind=use >HTMLSelectElement</span> ||
          <span data-id="15" data-kind=use >element</span> instanceof <span data-id="6" data-kind=use >HTMLButtonElement</span>)) {
      return;
    }

    // Don't connect up to the same element more than once.
    if (this.<span data-id="#_element" data-kind=use data-extra="FormSubmitObserver#_element">_element</span> == <span data-id="15" data-kind=use >element</span>) {
      this.<span data-id="#_showPopup" data-kind=use data-extra="FormSubmitObserver#_showPopup">_showPopup</span>(<span data-id="15" data-kind=use >element</span>);
      return;
    }
    this.<span data-id="#_element" data-kind=assign data-extra="FormSubmitObserver#_element">_element</span> = <span data-id="15" data-kind=use >element</span>;

    <span data-id="15" data-kind=use >element</span>.<span data-id="#focus" data-kind=use data-extra="element#focus">focus</span>();

    this.<span data-id="#_validationMessage" data-kind=assign data-extra="FormSubmitObserver#_validationMessage">_validationMessage</span> = <span data-id="15" data-kind=use >element</span>.<span data-id="#validationMessage" data-kind=use data-extra="element#validationMessage">validationMessage</span>;

    // Watch for input changes which may change the validation message.
    <span data-id="15" data-kind=use >element</span>.<span data-id="#addEventListener" data-kind=use data-extra="element#addEventListener">addEventListener</span>("input", this, false);

    // Watch for focus changes so we can disconnect our listeners and
    // hide the popup.
    <span data-id="15" data-kind=use >element</span>.<span data-id="#addEventListener" data-kind=use data-extra="element#addEventListener">addEventListener</span>("blur", this, false);

    this.<span data-id="#_showPopup" data-kind=use data-extra="FormSubmitObserver#_showPopup">_showPopup</span>(<span data-id="15" data-kind=use >element</span>);
  },

  /*
   * Internal
   */
  
  /*
   * Handles input changes on the form element we've associated a popup
   * with. Updates the validation message or closes the popup if form data
   * becomes valid.
   */
  <span data-id="#_onInput" data-kind=def data-extra="FormSubmitObserver#_onInput">_onInput</span>: function (<span data-id="16" data-kind=def >aEvent</span>) {
    let <span data-id="17" data-kind=def >element</span> = <span data-id="16" data-kind=use >aEvent</span>.<span data-id="#originalTarget" data-kind=use data-extra="aEvent#originalTarget">originalTarget</span>;

    // If the form input is now valid, hide the popup.
    if (<span data-id="17" data-kind=use >element</span>.<span data-id="#validity" data-kind=use data-extra="element#validity">validity</span>.<span data-id="#valid" data-kind=use >valid</span>) {
      this.<span data-id="#_hidePopup" data-kind=use data-extra="FormSubmitObserver#_hidePopup">_hidePopup</span>();
      return;
    }

    // If the element is still invalid for a new reason, we should update
    // the popup error message.
    if (this.<span data-id="#_validationMessage" data-kind=use data-extra="FormSubmitObserver#_validationMessage">_validationMessage</span> != <span data-id="17" data-kind=use >element</span>.<span data-id="#validationMessage" data-kind=use data-extra="element#validationMessage">validationMessage</span>) {
      this.<span data-id="#_validationMessage" data-kind=assign data-extra="FormSubmitObserver#_validationMessage">_validationMessage</span> = <span data-id="17" data-kind=use >element</span>.<span data-id="#validationMessage" data-kind=use data-extra="element#validationMessage">validationMessage</span>;
      this.<span data-id="#_showPopup" data-kind=use data-extra="FormSubmitObserver#_showPopup">_showPopup</span>(<span data-id="17" data-kind=use >element</span>);
    }
  },

  /*
   * Blur event handler in which we disconnect from the form element and
   * hide the popup.
   */
  <span data-id="#_onBlur" data-kind=def data-extra="FormSubmitObserver#_onBlur">_onBlur</span>: function (<span data-id="18" data-kind=def >aEvent</span>) {
    <span data-id="18" data-kind=use >aEvent</span>.<span data-id="#originalTarget" data-kind=use data-extra="aEvent#originalTarget">originalTarget</span>.<span data-id="#removeEventListener" data-kind=use >removeEventListener</span>("input", this, false);
    <span data-id="18" data-kind=use >aEvent</span>.<span data-id="#originalTarget" data-kind=use data-extra="aEvent#originalTarget">originalTarget</span>.<span data-id="#removeEventListener" data-kind=use >removeEventListener</span>("blur", this, false);
    this.<span data-id="#_element" data-kind=assign data-extra="FormSubmitObserver#_element">_element</span> = null;
    this.<span data-id="#_hidePopup" data-kind=use data-extra="FormSubmitObserver#_hidePopup">_hidePopup</span>();
  },

  /*
   * Send the show popup message to chrome with appropriate position
   * information. Can be called repetitively to update the currently
   * displayed popup position and text.
   */
  <span data-id="#_showPopup" data-kind=def data-extra="FormSubmitObserver#_showPopup">_showPopup</span>: function (<span data-id="19" data-kind=def >aElement</span>) {
    // Collect positional information and show the popup
    let <span data-id="20" data-kind=def >panelData</span> = {};

    <span data-id="20" data-kind=use >panelData</span>.<span data-id="#message" data-kind=assign data-extra="panelData#message">message</span> = this.<span data-id="#_validationMessage" data-kind=use data-extra="FormSubmitObserver#_validationMessage">_validationMessage</span>;

    // Note, this is relative to the browser and needs to be translated
    // in chrome.
    <span data-id="20" data-kind=use >panelData</span>.<span data-id="#contentRect" data-kind=assign data-extra="panelData#contentRect">contentRect</span> = this.<span data-id="#_msgRect" data-kind=use data-extra="FormSubmitObserver#_msgRect">_msgRect</span>(<span data-id="19" data-kind=use >aElement</span>);

    // We want to show the popup at the middle of checkbox and radio buttons
    // and where the content begin for the other elements.
    let <span data-id="21" data-kind=def >offset</span> = 0;
    let <span data-id="22" data-kind=def >position</span> = "";

    if (<span data-id="19" data-kind=use >aElement</span>.<span data-id="#tagName" data-kind=use data-extra="aElement#tagName">tagName</span> == 'INPUT' &&
        (<span data-id="19" data-kind=use >aElement</span>.<span data-id="#type" data-kind=use data-extra="aElement#type">type</span> == 'radio' || <span data-id="19" data-kind=use >aElement</span>.<span data-id="#type" data-kind=use data-extra="aElement#type">type</span> == 'checkbox')) {
      <span data-id="20" data-kind=use >panelData</span>.<span data-id="#position" data-kind=assign data-extra="panelData#position">position</span> = "bottomcenter topleft";
    } else {
      let <span data-id="23" data-kind=def >win</span> = <span data-id="19" data-kind=use >aElement</span>.<span data-id="#ownerDocument" data-kind=use data-extra="aElement#ownerDocument">ownerDocument</span>.<span data-id="#defaultView" data-kind=use >defaultView</span>;
      let <span data-id="24" data-kind=def >style</span> = <span data-id="23" data-kind=use >win</span>.<span data-id="#getComputedStyle" data-kind=use data-extra="win#getComputedStyle">getComputedStyle</span>(<span data-id="19" data-kind=use >aElement</span>, null);
      if (<span data-id="24" data-kind=use >style</span>.<span data-id="#direction" data-kind=use data-extra="style#direction">direction</span> == 'rtl') {
        <span data-id="21" data-kind=assign >offset</span> = <span data-id="?" data-kind=use >parseInt</span>(<span data-id="24" data-kind=use >style</span>.<span data-id="#paddingRight" data-kind=use data-extra="style#paddingRight">paddingRight</span>) + <span data-id="?" data-kind=use >parseInt</span>(<span data-id="24" data-kind=use >style</span>.<span data-id="#borderRightWidth" data-kind=use data-extra="style#borderRightWidth">borderRightWidth</span>);
      } else {
        <span data-id="21" data-kind=assign >offset</span> = <span data-id="?" data-kind=use >parseInt</span>(<span data-id="24" data-kind=use >style</span>.<span data-id="#paddingLeft" data-kind=use data-extra="style#paddingLeft">paddingLeft</span>) + <span data-id="?" data-kind=use >parseInt</span>(<span data-id="24" data-kind=use >style</span>.<span data-id="#borderLeftWidth" data-kind=use data-extra="style#borderLeftWidth">borderLeftWidth</span>);
      }
      let <span data-id="25" data-kind=def >zoomFactor</span> = this.<span data-id="#_getWindowUtils" data-kind=use data-extra="FormSubmitObserver#_getWindowUtils">_getWindowUtils</span>().<span data-id="#fullZoom" data-kind=use >fullZoom</span>;
      <span data-id="20" data-kind=use >panelData</span>.<span data-id="#offset" data-kind=assign data-extra="panelData#offset">offset</span> = <span data-id="?" data-kind=use >Math</span>.<span data-id="#round" data-kind=use data-extra="Math#round">round</span>(<span data-id="21" data-kind=use >offset</span> * <span data-id="25" data-kind=use >zoomFactor</span>);
      <span data-id="20" data-kind=use >panelData</span>.<span data-id="#position" data-kind=assign data-extra="panelData#position">position</span> = "after_start";
    }
    this.<span data-id="#_mm" data-kind=use data-extra="FormSubmitObserver#_mm">_mm</span>.<span data-id="#sendAsyncMessage" data-kind=use >sendAsyncMessage</span>("FormValidation:ShowPopup", <span data-id="20" data-kind=use >panelData</span>);
  },

  <span data-id="#_hidePopup" data-kind=def data-extra="FormSubmitObserver#_hidePopup">_hidePopup</span>: function () {
    this.<span data-id="#_mm" data-kind=use data-extra="FormSubmitObserver#_mm">_mm</span>.<span data-id="#sendAsyncMessage" data-kind=use >sendAsyncMessage</span>("FormValidation:HidePopup", {});
  },

  <span data-id="#_getWindowUtils" data-kind=def data-extra="FormSubmitObserver#_getWindowUtils">_getWindowUtils</span>: function () {
    return this.<span data-id="#_content" data-kind=use data-extra="FormSubmitObserver#_content">_content</span>.<span data-id="#QueryInterface" data-kind=use >QueryInterface</span>(<span data-id="1" data-kind=use >Ci</span>.<span data-id="#nsIInterfaceRequestor" data-kind=use data-extra="Ci#nsIInterfaceRequestor">nsIInterfaceRequestor</span>).<span data-id="#getInterface" data-kind=use >getInterface</span>(<span data-id="1" data-kind=use >Ci</span>.<span data-id="#nsIDOMWindowUtils" data-kind=use data-extra="Ci#nsIDOMWindowUtils">nsIDOMWindowUtils</span>);
  },

  <span data-id="#_isRootDocumentEvent" data-kind=def data-extra="FormSubmitObserver#_isRootDocumentEvent">_isRootDocumentEvent</span>: function (<span data-id="26" data-kind=def >aEvent</span>) {
    if (this.<span data-id="#_content" data-kind=use data-extra="FormSubmitObserver#_content">_content</span> == null) {
      return true;
    }
    let <span data-id="27" data-kind=def >target</span> = <span data-id="26" data-kind=use >aEvent</span>.<span data-id="#originalTarget" data-kind=use data-extra="aEvent#originalTarget">originalTarget</span>;
    return (<span data-id="27" data-kind=use >target</span> == this.<span data-id="#_content" data-kind=use data-extra="FormSubmitObserver#_content">_content</span>.<span data-id="#document" data-kind=use >document</span> ||
            (<span data-id="27" data-kind=use >target</span>.<span data-id="#ownerDocument" data-kind=use data-extra="target#ownerDocument">ownerDocument</span> && <span data-id="27" data-kind=use >target</span>.<span data-id="#ownerDocument" data-kind=use data-extra="target#ownerDocument">ownerDocument</span> == this.<span data-id="#_content" data-kind=use data-extra="FormSubmitObserver#_content">_content</span>.<span data-id="#document" data-kind=use >document</span>));
  },

  /*
   * Return a message manager rect for the element's bounding client rect
   * in top level browser coords.
   */
  <span data-id="#_msgRect" data-kind=def data-extra="FormSubmitObserver#_msgRect">_msgRect</span>: function (<span data-id="28" data-kind=def >aElement</span>) {
    let <span data-id="29" data-kind=def >domRect</span> = <span data-id="28" data-kind=use >aElement</span>.<span data-id="#getBoundingClientRect" data-kind=use data-extra="aElement#getBoundingClientRect">getBoundingClientRect</span>();
    let <span data-id="30" data-kind=def >zoomFactor</span> = this.<span data-id="#_getWindowUtils" data-kind=use data-extra="FormSubmitObserver#_getWindowUtils">_getWindowUtils</span>().<span data-id="#fullZoom" data-kind=use >fullZoom</span>;
    let { <span data-id="31" data-kind=def >offsetX</span>, <span data-id="32" data-kind=def >offsetY</span> } = <span data-id="?" data-kind=use >BrowserUtils</span>.<span data-id="#offsetToTopLevelWindow" data-kind=use data-extra="BrowserUtils#offsetToTopLevelWindow">offsetToTopLevelWindow</span>(this.<span data-id="#_content" data-kind=use data-extra="FormSubmitObserver#_content">_content</span>, <span data-id="28" data-kind=use >aElement</span>);
    return {
      <span data-id="#left" data-kind=def data-extra="FormSubmitObserver#left">left</span>: (<span data-id="29" data-kind=use >domRect</span>.<span data-id="#left" data-kind=use data-extra="domRect#left">left</span> + <span data-id="31" data-kind=use >offsetX</span>) * <span data-id="30" data-kind=use >zoomFactor</span>,
      <span data-id="#top" data-kind=def data-extra="FormSubmitObserver#top">top</span>: (<span data-id="29" data-kind=use >domRect</span>.<span data-id="#top" data-kind=use data-extra="domRect#top">top</span> + <span data-id="32" data-kind=use >offsetY</span>) * <span data-id="30" data-kind=use >zoomFactor</span>,
      <span data-id="#width" data-kind=def data-extra="FormSubmitObserver#width">width</span>: <span data-id="29" data-kind=use >domRect</span>.<span data-id="#width" data-kind=use data-extra="domRect#width">width</span> * <span data-id="30" data-kind=use >zoomFactor</span>,
      <span data-id="#height" data-kind=def data-extra="FormSubmitObserver#height">height</span>: <span data-id="29" data-kind=use >domRect</span>.<span data-id="#height" data-kind=use data-extra="domRect#height">height</span> * <span data-id="30" data-kind=use >zoomFactor</span>
    };
  },

  <span data-id="#QueryInterface" data-kind=def data-extra="FormSubmitObserver#QueryInterface">QueryInterface</span> : <span data-id="?" data-kind=use >XPCOMUtils</span>.<span data-id="#generateQI" data-kind=use data-extra="XPCOMUtils#generateQI">generateQI</span>([<span data-id="1" data-kind=use >Ci</span>.<span data-id="#nsIFormSubmitObserver" data-kind=use data-extra="Ci#nsIFormSubmitObserver">nsIFormSubmitObserver</span>])
};

</code></pre>

<script src="context-menu.js"></script>

</body>
</html>
